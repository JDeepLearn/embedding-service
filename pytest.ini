# ===================================================================
# Pytest Configuration - Embedding Service
# ===================================================================
# Purpose:
#   Provides consistent test behavior across local, CI/CD, and Docker.
#   Disables noisy plugins, enforces clean output, and ensures stable runs.
# ===================================================================

[pytest]

# ------------------------------
# Test discovery
# ------------------------------
testpaths =
    tests

python_files = test_*.py
python_classes = Test*
python_functions = test_*

# ------------------------------
# Default run options
# ------------------------------
addopts =
    -q
    --disable-warnings
    --maxfail=1
    --tb=short
    --color=yes
    -p no:dash
    -p no:flask

# ------------------------------
# Logging & Output
# ------------------------------
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)s] %(message)s
log_date_format = %Y-%m-%d %H:%M:%S

# ------------------------------
# Coverage Integration (Optional)
# ------------------------------
# Uncomment if you enable pytest-cov in the future:
# addopts = --cov=embedding_service --cov-report=term-missing --cov-fail-under=90

# ------------------------------
# Failures and Exit Codes
# ------------------------------
# Ensures consistent exit codes for CI/CD
junit_family = xunit2

# ------------------------------
# Environment Consistency
# ------------------------------
# Disables caching across parallel CI runs for determinism
cache_dir = .pytest_cache
